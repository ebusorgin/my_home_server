<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Myhomeserver</title>
    <base href="/">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <script src="/socket.io/socket.io.js"></script>
    <script src="/js/jquery.js"></script>
    <link href="/css/style.css" rel="stylesheet">
</head>
<body>
<div class="frame">


    <button class="light_button btn1" onclick="setLight('btn1')">туалет</button>
    <button class="light_button btn2" onclick="setLight('btn2')">коридор</button>
    <button class="light_button btn3" onclick="setLight('btn3')">кухня</button>
    <button class="light_button btn4" onclick="setLight('btn4')">комната</button>
    <hr>
    <button class="light_button btn5" onclick="setLight('btn5')">балкон</button>
    <button class="light_button btn6" onclick="setLight('btn6')">комната 1</button>
    <button class="light_button btn7" onclick="setLight('btn7')">комната 2</button>
    <hr>
    <button class="light_button light_hangar_gates" onclick="setLight('light_hangar_gates')">свет двор</button>
    <button class="light_button light_hangar_gates" onclick="setLight('light_hangar_gates')">свет ворота</button>
    <hr>
    <button class="light_button gate_door" onclick="setDoor('gate_door')">дверь ворота
        (<span
            id="is_open_door"></span>)
    </button>
</div>
</body>
</html>
<script>
    let CONFIG = {}
    let socket = io();
    setDoor = (btn) => {
        CONFIG[btn] == 1 ? CONFIG[btn] = 0 : CONFIG[btn] = 1;
        socket.emit('door', CONFIG)
    }
    setLight = (btn) => {
        $('.' + btn).css({backgroundColor: CONFIG[btn] == 1 ? '#b47c00' : '#595959'});
        CONFIG[btn] == 1 ? CONFIG[btn] = 0 : CONFIG[btn] = 1;
        socket.emit('light', CONFIG)
    }

    socket.on('config', function (msg) {
        CONFIG = msg
        Object.keys(CONFIG).map((btn) => {


            if (btn == 'is_open_door') {
                if (CONFIG[btn] == 0) {
                    $('#' + btn).text('CLOSE');
                    $('.gate_door').css({backgroundColor: '#830303'});
                } else {
                    $('#' + btn).text('OPEN');
                    $('.gate_door').css({backgroundColor: '#34b611'});
                }
            } else if(btn == 'gate_door'){
                // $('.'+btn).css({backgroundColor: CONFIG[btn]==0?'#34b611':'#525252'});
            }
            else{
                $('.'+btn).css({backgroundColor: CONFIG[btn]==0?'#ffc538':'#706E6EFF'});
            }


        })
        console.log('msg', msg)
    });
</script>
